{% extends "base/base.html" %}
{% load i18n %}

{% block title %}
{% trans 'Home' %} - TZ Mebel
{% endblock %}

{% block content %}

<main id="home" class="hero container section animate-fade-in">
    <div class="hero-content">
        <div class="hero-text animate-slide-up">
            <div class="hero-badge">
                <span class="badge-icon rotate-animation">✨</span>
                <span>{% trans 'Custom furniture to order' %}</span>
            </div>
            <h1 class="hero-title animate-text-reveal">
                {% trans 'We create furniture' %} <br>
                <span class="gradient-text glow-text">{% trans 'dreams' %}</span> {% trans 'for your home' %}
            </h1>
            <p class="hero-description animate-slide-up" style="animation-delay: 0.3s;">
                {% trans 'Design and manufacture of unique furniture for your interior. From idea to implementation — 100% quality and attention to detail.' %}
            </p>
            <div class="hero-actions animate-slide-up" style="animation-delay: 0.6s;">
                <button class="btn btn-primary hover-lift" onclick="openConsultationModal()">{% trans 'Get consultation' %}</button>
                <a href="#portfolio" class="btn btn-outline hover-lift">{% trans 'View works' %}</a>
            </div>
            <div class="hero-features animate-fade-in" style="animation-delay: 0.9s;">
                <div class="feature-item hover-scale">
                    <span class="feature-icon bounce-animation">🚚</span>
                    <span>{% trans 'Delivery 2-4 weeks' %}</span>
                </div>
                <div class="feature-item hover-scale">
                    <span class="feature-icon bounce-animation" style="animation-delay: 0.2s;">🛡️</span>
                    <span>{% trans 'Quality guarantee' %}</span>
                </div>
                <div class="feature-item hover-scale">
                    <span class="feature-icon bounce-animation" style="animation-delay: 0.4s;">⭐</span>
                    <span>{{ total_projects }}+ {% trans 'clients' %}</span>
                </div>
            </div>
        </div>
        <div class="hero-visual animate-slide-up" style="animation-delay: 0.4s;">
            <div class="hero-card floating-card">
                <div class="hero-image">
                    <div class="orbit-dot"></div>
                </div>
                <div class="floating-elements">
                    <div class="floating-element element-1 float-animation">
                        <svg class="furniture-icon chair-icon" viewBox="0 0 24 24" width="48" height="48">
                            <path fill="currentColor" d="M7.5 10c-.28 0-.5.22-.5.5v1h9v-1c0-.28-.22-.5-.5-.5h-8zm-3 3c-.28 0-.5.22-.5.5v4c0 .28.22.5.5.5h1.5v2.5c0 .28.22.5.5.5h1c.28 0 .5-.22.5-.5v-2.5h7v2.5c0 .28.22.5.5.5h1c.28 0 .5-.22.5-.5v-2.5h1.5c.28 0 .5-.22.5-.5v-4c0-.28-.22-.5-.5-.5h-13zm13.5-7c-.28 0-.5.22-.5.5v1h-11v-1c0-.28-.22-.5-.5-.5s-.5.22-.5.5v1c0 .28.22.5.5.5h.5v5h11v-5h.5c.28 0 .5-.22.5-.5v-1c0-.28-.22-.5-.5-.5z"/>
                        </svg>
                    </div>
                    <div class="floating-element element-2 float-animation" style="animation-delay: 1s;">
                        <svg class="furniture-icon bed-icon" viewBox="0 0 24 24" width="48" height="48">
                            <path fill="currentColor" d="M19 10v7h-2v-7H7v7H5v-7c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v1c0 .28.22.5.5.5h.5v5h11v-5h.5c.28 0 .5-.22.5-.5v-1c0-.28-.22-.5-.5-.5z"/>
                        </svg>
                    </div>
                    <div class="floating-element element-3 float-animation" style="animation-delay: 2s;">
                        <svg class="furniture-icon cabinet-icon" viewBox="0 0 24 24" width="48" height="48">
                            <path fill="currentColor" d="M20 4H4c-1.11 0-2 .89-2 2v12c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm-9 6H6v4h5v-4zm2 0v4h5v-4h-5zm-8-6h14c.55 0 1 .45 1 1s-.45 1-1 1H5c-.55 0-1-.45-1-1s.45-1 1-1z"/>
                        </svg>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<section id="delivery" class="section container">
    <div class="delivery-hero">
        <div class="delivery-content">
            <div class="section-title">{% trans 'Furniture creation process' %}</div>
            <div class="section-sub">{% trans 'From idea to finished product — every stage under control' %}</div>
        </div>
        <div class="process-timeline">
            <div class="process-step">
                <div class="step-number">1</div>
                <div class="step-content">
                    <h4>{% trans 'Consultation' %}</h4>
                    <p>{% trans 'We discuss your ideas and requirements' %}</p>
                </div>
            </div>
            <div class="process-step">
                <div class="step-number">2</div>
                <div class="step-content">
                    <h4>{% trans 'Design' %}</h4>
                    <p>{% trans 'We create 3D models and drawings' %}</p>
                </div>
            </div>
            <div class="process-step">
                <div class="step-number">3</div>
                <div class="step-content">
                    <h4>{% trans 'Production' %}</h4>
                    <p>{% trans 'We manufacture with quality control' %}</p>
                </div>
            </div>
            <div class="process-step">
                <div class="step-number">4</div>
                <div class="step-content">
                    <h4>{% trans 'Delivery' %}</h4>
                    <p>{% trans 'We carefully deliver and install' %}</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section id="stats" class="section container">
    <div class="stats-hero">
        <div class="section-header">
            <div>
                <div class="section-title">{% trans 'About us in numbers' %}</div>
                <div class="section-sub">{% trans 'Facts that clients trust' %}</div>
            </div>
            <div class="stats-badge">
                <span class="badge-icon">📊</span>
                <span class="badge-text">{% trans 'Verified data' %}</span>
            </div>
        </div>
        {% if stats %}
        <div class="stats-enhanced">
            <div class="stat-card stat-clients">
                <div class="stat-background">
                    <div class="background-pattern"></div>
                </div>
                <div class="stat-content">
                    <div class="stat-icon-wrapper">
                        <div class="stat-icon">👥</div>
                        <div class="icon-glow"></div>
                    </div>
                    <div class="stat-data">
                        <div class="num" data-count="{{ stats.clients_count }}">0</div>
                        <div class="num-suffix">+</div>
                    </div>
                    <div class="label">{% trans 'Satisfied clients' %}</div>
                    <div class="stat-description">{% trans 'High trust rating' %}</div>
                    <div class="progress-enhanced">
                        <div class="progress-bar" data-width="95"></div>
                        <div class="progress-glow"></div>
                    </div>
                </div>
                <div class="stat-sparkle">
                    <div class="sparkle sparkle-1"></div>
                    <div class="sparkle sparkle-2"></div>
                    <div class="sparkle sparkle-3"></div>
                </div>
            </div>

            <div class="stat-card stat-projects">
                <div class="stat-background">
                    <div class="background-pattern"></div>
                </div>
                <div class="stat-content">
                    <div class="stat-icon-wrapper">
                        <div class="stat-icon">🏠</div>
                        <div class="icon-glow"></div>
                    </div>
                    <div class="stat-data">
                        <div class="num" data-count="{{ stats.projects_count }}">0</div>
                        <div class="num-suffix">+</div>
                    </div>
                    <div class="label">{% trans 'Completed projects' %}</div>
                    <div class="stat-description">{% trans 'Unique furniture' %}</div>
                    <div class="progress-enhanced">
                        <div class="progress-bar" data-width="88"></div>
                        <div class="progress-glow"></div>
                    </div>
                </div>
                <div class="stat-sparkle">
                    <div class="sparkle sparkle-1"></div>
                    <div class="sparkle sparkle-2"></div>
                    <div class="sparkle sparkle-3"></div>
                </div>
            </div>

            <div class="stat-card stat-experience">
                <div class="stat-background">
                    <div class="background-pattern"></div>
                </div>
                <div class="stat-content">
                    <div class="stat-icon-wrapper">
                        <div class="stat-icon">📅</div>
                        <div class="icon-glow"></div>
                    </div>
                    <div class="stat-data">
                        <div class="num" data-count="{{ stats.years_experience }}">0</div>
                        <div class="num-suffix"></div>
                    </div>
                    <div class="label">{% trans 'Years of experience' %}</div>
                    <div class="stat-description">{% trans 'Professional expertise' %}</div>
                    <div class="progress-enhanced">
                        <div class="progress-bar" data-width="92"></div>
                        <div class="progress-glow"></div>
                    </div>
                </div>
                <div class="stat-sparkle">
                    <div class="sparkle sparkle-1"></div>
                    <div class="sparkle sparkle-2"></div>
                    <div class="sparkle sparkle-3"></div>
                </div>
            </div>

            <div class="stat-card stat-delivery">
                <div class="stat-background">
                    <div class="background-pattern"></div>
                </div>
                <div class="stat-content">
                    <div class="stat-icon-wrapper">
                        <div class="stat-icon">⚡</div>
                        <div class="icon-glow"></div>
                    </div>
                    <div class="stat-data">
                        <div class="num" data-count="{{ stats.delivery_weeks }}">0</div>
                        <div class="num-suffix"></div>
                    </div>
                    <div class="label">{% trans 'Weeks to delivery' %}</div>
                    <div class="stat-description">{% trans 'Fast implementation' %}</div>
                    <div class="progress-enhanced">
                        <div class="progress-bar" data-width="85"></div>
                        <div class="progress-glow"></div>
                    </div>
                </div>
                <div class="stat-sparkle">
                    <div class="sparkle sparkle-1"></div>
                    <div class="sparkle sparkle-2"></div>
                    <div class="sparkle sparkle-3"></div>
                </div>
            </div>
        </div>

        <!-- Дополнительная информация -->
        <div class="stats-footer">
            <div class="stats-highlight">
                <div class="highlight-item">
                    <span class="highlight-icon">🏆</span>
                    <span class="highlight-text">{% trans 'Leader in custom furniture' %}</span>
                </div>
                <div class="highlight-item">
                    <span class="highlight-icon">💎</span>
                    <span class="highlight-text">{% trans 'Premium quality materials' %}</span>
                </div>
                <div class="highlight-item">
                    <span class="highlight-icon">🎯</span>
                    <span class="highlight-text">{% trans 'Precise deadlines' %}</span>
                </div>
            </div>
        </div>
        {% endif %}
    </div>
</section>

<div class="container">
    <section id="features" class="section">
        <div class="section-header">
            <h2 class="section-title">{% trans 'Why choose us' %}</h2>
        </div>
        <div class="features">
            <div class="feature">
                <div class="icon-wrapper">🚚</div>
                <h4>{% trans 'Fast delivery' %}</h4>
                <p>{% trans 'From 2 to 4 weeks — we transparently plan deadlines and stick to them. We deliver throughout Russia with careful packaging.' %}</p>
            </div>
            <div class="feature">
                <div class="icon-wrapper">🛡️</div>
                <h4>{% trans 'Quality guarantee' %}</h4>
                <p>{% trans 'Reliable materials, careful assembly and control at every stage. We provide an official warranty on all products.' %}</p>
            </div>
            <div class="feature">
                <div class="icon-wrapper">⭐</div>
                <h4>{% trans 'Experienced craftsmen' %}</h4>
                <p>{% trans 'Dozens of completed projects — from kitchens to wardrobes. Our specialists constantly improve their qualifications.' %}</p>
            </div>
            <div class="feature">
                <div class="icon-wrapper">🎯</div>
                <h4>{% trans 'Individual approach' %}</h4>
                <p>{% trans 'We will adapt to your style and budget — we will offer the best solutions. Free consultations and 3D project visualization.' %}</p>
            </div>
        </div>
    </section>
</div>

<section id="portfolio" class="section container animate-fade-in">
    <div class="portfolio-hero">
        <div class="section-header">
            <div>
                <h2 class="section-title glow-text">{% trans 'Our Works' %}</h2>
                <p class="section-subtitle">{% trans 'Portfolio of unique handmade furniture' %}</p>
            </div>
            <a href="{% url 'client_service:portfolio' %}" class="portfolio-view-all hover-lift">
                <span>{% trans 'View all' %}</span>
                <span class="arrow bounce-animation">→</span>
            </a>
        </div>

        <div class="portfolio-showcase">
            {% if works %}
            {% for work in works %}
            <article class="showcase-card hover-lift animate-slide-up">
                <div class="card-image-wrapper">
                    <img src="{{ work.image.url }}" alt="{{ work.title }}" class="showcase-image" loading="lazy">
                    <div class="image-overlay">
                        <div class="overlay-content">
                            <button class="quick-preview" onclick="quickView('{{ work.id }}')">
                                <span class="preview-icon">👁️</span>
                                <span>{% trans 'Quick view' %}</span>
                            </button>
                        </div>
                    </div>
                    <div class="card-category">
                        <span class="category-badge">{{ work.get_work_type_display }}</span>
                    </div>
                </div>

                <div class="card-content">
                    <div class="card-content-wrapper">
                        <div class="card-main-content">
                            <div class="card-header">
                                <div class="card-meta">
                                    <h3 class="card-title">{{ work.title|truncatewords:3 }}</h3>
                                </div>
                            </div>
                            <p class="card-description">{{ work.description|default:"{% trans 'Description will appear soon' %}"|truncatewords:15 }}</p>
                            <p class="meta-date" style="color: #cbd5e1; font-size: 14px;">📅 {{ work.date|date:"M Y" }}</p>
                            <!--                            {% if work.material %}-->
                            <!--                            <p class="meta-material" style="color: #cbd5e1; font-size: 14px;">🪵 {{ work.material }}</p>-->
                            <!--                            {% endif %}-->
                        </div>

                        <div class="card-footer">
                            <div class="price-info">
                                <span class="price-label">{% trans 'Cost' %}</span>
                                <span class="price-value">{{ work.price }}</span>
                                <span class="price-unit">{{ work.currency|upper }}</span>
                            </div>
                            <!--                            <a href="{% url 'client_service:work_detail' work.pk %}" class="details-btn">-->
                            <!--                                <span>Подробнее</span>-->
                            <!--                                <span class="btn-arrow">→</span>-->
                            <!--                            </a>-->
                        </div>
                    </div>
                </div>
            </article>
            {% endfor %}
            {% else %}
            <div class="no-works">
                <h3>{% trans 'No works in the database!' %}</h3>
            </div>
            {% endif %}
        </div>

        <div class="portfolio-cta">
            <p class="cta-text">{% trans 'Didn\'t find what you were looking for?' %}</p>
            <button class="btn btn-primary" onclick="openConsultationModal()">
                <span class="btn-icon">💬</span>
                <span>{% trans 'Discuss individual project' %}</span>
            </button>
        </div>
    </div>
</section>

<section id="reviews" class="section container reviews">
    <div class="section-header">
        <div>
            <div class="section-title">{% trans 'Customer reviews' %}</div>
            <div class="section-sub">{% trans 'More than 1000 satisfied customers trust us to create dream furniture' %}</div>
        </div>
        <div class="reviews-stats">
            <div class="stat-item">
                <span class="stat-number">{{ avg_rating }}</span>
                <div class="stars-display">
                    {% for i in "12345" %}
                    {% if forloop.counter <= avg_rating %}
                    <span class="star filled">★</span>
                    {% else %}
                    <span class="star">☆</span>
                    {% endif %}
                    {% endfor %}
                </div>
                <span class="stat-label">{% trans 'Average rating' %}</span>
            </div>
        </div>
    </div>

    <div class="reviews-container">
        <div class="reviews-viewport">
            <div class="reviews-track" id="reviewsTrack">
                {% if reviews %}
                {% for review in reviews %}
                <div class="review-card">
                    <div class="review-header">
                        <div class="client-info">
                            <div class="avatar-wrapper">
                                <div class="avatar">
                                    <span class="avatar-initial">{{ review.author_name|first|upper }}</span>
                                </div>
                                <div class="verified-badge" title="{% trans 'Verified client' %}">
                                    <span class="verified-icon">✓</span>
                                </div>
                            </div>
                            <div class="client-details">
                                <div class="client-name">{{ review.author_name }}</div>
                                <div class="client-meta">
                                    <span class="date">{{ review.date|date:"d M Y" }}</span>
                                    <span class="separator">•</span>
                                    <span class="client-type">{% trans 'Verified client' %}</span>
                                </div>
                            </div>
                        </div>
                        <div class="review-rating">
                            <div class="stars">
                                {% for i in "12345" %}
                                {% if forloop.counter <= review.rating %}
                                <span class="star filled">★</span>
                                {% else %}
                                <span class="star">☆</span>
                                {% endif %}
                                {% endfor %}
                            </div>
                        </div>
                    </div>

                    <div class="review-content">
                        <blockquote class="review-text">"{{ review.text }}"</blockquote>
                        <div class="review-project">
                            <span class="project-label">{% trans 'Project:' %}</span>
                            <span class="project-name">{{ review.project_name|default:"{% trans 'Custom furniture' %}" }}</span>
                        </div>
                    </div>

                    <div class="review-footer">
                        <div class="helpful-section">
                            <button class="helpful-btn" data-review-id="{{ review.id }}">
                                <span class="helpful-icon">👍</span>
                                <span class="helpful-text">{% trans 'Helpful' %}</span>
                                <span class="helpful-count">({{ review.helpful_count }})</span>
                            </button>
                        </div>
                        <div class="review-source">
                            <span class="source-icon">🏢</span>
                            <span class="source-text">{% trans 'TZ Mebel' %}</span>
                        </div>
                    </div>
                </div>
                {% endfor %}
                {% else %}
                <div class="no-reviews">
                    <div class="no-reviews-icon">💬</div>
                    <h3>{% trans 'Reviews will appear soon!' %}</h3>
                    <p>{% trans 'Be the first to leave a review about our work' %}</p>
                    <button class="btn btn-primary" onclick="openConsultationModal()">
                        {% trans 'Order project' %}
                    </button>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Навигация карусели -->


        <div class="reviews-navigation">
            <button class="nav-btn prev-btn" id="reviewsPrev" aria-label="{% trans 'Previous review' %}">
                <span class="nav-icon">‹</span>
            </button>
            <div class="reviews-dots" id="reviewsDots"></div>
            <button class="nav-btn next-btn" id="reviewsNext" aria-label="{% trans 'Next review' %}">
                <span class="nav-icon">›</span>
            </button>
        </div>
    </div>

    <!-- Призыв к действию -->
    <div class="reviews-cta">
        <div class="cta-content">
            <h3 class="cta-title">{% trans 'Want to join satisfied customers?' %}</h3>
            <p class="cta-description">{% trans 'Get a free consultation and find out how we can make your dream of perfect furniture come true' %}</p>
            <div class="cta-actions">
                <button class="btn btn-primary" onclick="openConsultationModal()">
                    <span class="btn-icon">📞</span>
                    <span>{% trans 'Get consultation' %}</span>
                </button>
                <a href="#portfolio" class="btn btn-outline">
                    <span>{% trans 'View our works' %}</span>
                    <span class="btn-arrow">→</span>
                </a>
            </div>
        </div>
        <div class="cta-visual">
            <div class="trust-indicators">
                <div class="trust-item">
                    <span class="trust-icon">🏆</span>
                    <span class="trust-text">{{ total_projects }}+ {% trans 'projects' %}</span>
                </div>
                <div class="trust-item">
                    <span class="trust-icon">⭐</span>
                    <span class="trust-text">{{ avg_rating }} {% trans 'rating' %}</span>
                </div>
                <div class="trust-item">
                    <span class="trust-icon">🛡️</span>
                    <span class="trust-text">{% trans 'Quality guarantee' %}</span>
                </div>
            </div>
        </div>
    </div>
</section>

<section id="contacts" class="section container">
    <div class="section-header">
        <div>
            <div class="section-title">{% trans 'Contacts' %}</div>
            <div class="section-sub">{% trans 'Choose a convenient branch for you' %}</div>
        </div>
    </div>
    <div class="branches">
        {% if contacts %}
        {% for contact in contacts %}
        <div class="branch">
            <div class="section-sub" style="color:#cfe3ff; font-weight:700;">{{ contact.branch_name }}</div>
            <div class="contact_row">🕐 {% if contact.start_time %}{{ contact.start_time|time:"g:i A" }}{% else %}—{% endif %} - {% if contact.end_time %}{{ contact.end_time|time:"g:i A" }}{% else %}—{% endif %}</div>
            <div class="contact-row">📞 {{ contact.phone }}</div>
            <div class="contact-row">📧 {{ contact.email }}</div>
            <div class="contact-row">📍 {{ contact.address }} | {{ contact.get_country_display }}</div>
            {% if contact.address %}
            <div class="contact-map">
                <a href="https://www.google.com/maps/search/?api=1&query={{ contact.address|urlencode }} {{ contact.get_country_display|urlencode }}" target="_blank" class="map-link">
                    <div class="mini-map" 
                         style="background-image: url('https://maps.googleapis.com/maps/api/staticmap?center={{ contact.address|urlencode }} {{ contact.get_country_display|urlencode }}&zoom=15&size=300x200&key=AIzaSyCV338EzjXB46qlz9tV5qCipoeTVvIqo4I');">
                        <div class="map-marker">📍</div>
                    </div>
                    <div class="map-overlay">
                        <span class="map-text">{% trans 'View on Google Maps' %}</span>
                    </div>
                </a>
            </div>
            {% endif %}
            <div class="contact-row"><a href="{{ contact.whatsapp }}">💬 WhatsApp</a> · <a href="{{ contact.instagram }}">📷 Instagram</a></div>
        </div>
        {% endfor %}
        {% else %}
        <h1>{% trans 'No contacts!' %}</h1>
        {% endif %}
    </div>
</section>

{% endblock %}
