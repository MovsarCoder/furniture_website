{% extends 'base/base.html' %}
{% load i18n %}

{% block title %}{% trans 'Our Works' %}{% endblock %}

{% block content %}

<section class="section">
    <div class="container">
        <!-- Enhanced Header with Statistics -->
        <div class="works-hero">
            <div class="section-header">
                <div>
                    <h1 class="section-title">{% trans 'Our Works' %}</h1>
                    <p class="section-subtitle">{% trans 'Portfolio of unique handmade furniture' %}</p>
                </div>
                <div class="works-stats">
                    <div class="stat-item">
                        <span class="stat-number">{{ works|length }}+</span>
                        <span class="stat-label">{% trans 'projects' %}</span>
                    </div>
                </div>
            </div>

            <!-- Filter Tabs -->
            <div class="filter-tabs">
                <button class="filter-tab active" data-filter="all">
                    <span class="tab-icon">🏠</span>
                    <span>{% trans 'All Works' %}</span>
                </button>
                <button class="filter-tab" data-filter="kitchen">
                    <span class="tab-icon">🍳</span>
                    <span>{% trans 'Kitchens' %}</span>
                </button>
                <button class="filter-tab" data-filter="wardrobe">
                    <span class="tab-icon">👔</span>
                    <span>{% trans 'Wardrobes' %}</span>
                </button>
                <button class="filter-tab" data-filter="table">
                    <span class="tab-icon">🪑</span>
                    <span>{% trans 'Tables' %}</span>
                </button>
                <button class="filter-tab" data-filter="cabinet">
                    <span class="tab-icon">📚</span>
                    <span>{% trans 'Cabinets' %}</span>
                </button>
            </div>
        </div>

        <!-- Enhanced Portfolio Grid -->
        <div class="portfolio-enhanced-grid" id="portfolioGrid">
            {% for work in works %}
            <article class="portfolio-card" data-category="{{ work.work_type }}">
                <div class="card-image-container">
                    <img src="{{ work.image.url }}" alt="{{ work.title }}" class="portfolio-image" loading="lazy">
                    <div class="image-overlay">
                        <button class="quick-view-btn" onclick="quickView('{{ work.id }}')">
                            <span class="btn-icon">👁️</span>
                            <span>{% trans 'Quick View' %}</span>
                        </button>
                    </div>
                    <div class="card-badges">
                        <span class="badge badge-category">{{ work.get_work_type_display }}</span>
                        {% if work.is_featured %}
                        <span class="badge badge-featured">⭐ {% trans 'Recommended' %}</span>
                        {% endif %}
                    </div>
                </div>

                <div class="card-content">
                    <div class="card-main-content">
                        <h3 class="card-title">{{ work.title|truncatewords:3 }}</h3>
                        <p class="card-description">{{ work.description|truncatewords:16|default:"Описание появится в ближайшее время" }}</p>

                        <div class="card-details">
                            {% if work.material %}
                            <div class="detail-item">
                                <span class="detail-icon">🪵</span>
                                <span class="detail-text">{{ work.material }}</span>
                            </div>
                            {% endif %}
                            <div class="detail-item">
                                <span class="detail-icon">📅</span>
                                <span class="detail-text">{{ work.date|date:"M Y" }}</span>
                            </div>
                        </div>
                    </div>

                    <div class="card-footer">
                        <div class="price-section">
                            <span class="price-label">{% trans 'Cost:' %}</span>
                            <span class="price-value">{{ work.price }}</span>
                            <span class="price-unit">{{ work.currency|upper }}</span>
                        </div>
                        <a href="{% url 'client_service:work_detail' work.id %}" class="view-btn">
                            <span>{% trans 'More details' %}</span>
                            <span class="btn-arrow">→</span>
                        </a>
                    </div>
                </div>
            </article>
            {% endfor %}
        </div>

        <!-- Call to Action Section -->
        <div class="works-cta">
            <div class="cta-content">
                <h3>{% trans 'Want to order similar furniture?' %}</h3>
                <p>{% trans 'Our masters will create a unique piece specially for you' %}</p>
                <button class="btn btn-primary" onclick="openConsultationModal()">
                    <span class="btn-icon">💬</span>
                    <span>{% trans 'Get consultation' %}</span>
                </button>
            </div>
        </div>
    </div>
</section>

<section id="contacts" class="section container">
    <div class="section-header">
        <div>
            <div class="section-title">{% trans 'Contacts' %}</div>
            <div class="section-sub">{% trans 'Choose a convenient branch for you' %}</div>
        </div>
    </div>
    <div class="branches">
        {% if contacts %}
        {% for contact in contacts %}
        <div class="branch">
            <div class="section-sub" style="color:#cfe3ff; font-weight:700;">{{ contact.branch_name }}</div>
            <div class="contact_row">🕑 {{ contact.start_time }} - {{ contact.end_time }} PM</div>
            <div class="contact-row">📞 {{ contact.phone }}</div>
            <div class="contact-row">📧 {{ contact.email }}</div>
            <div class="contact-row">📍 {{ contact.address }} | {{ contact.get_country_display }}</div>
            <div class="contact-row"><a href="{{ contact.whatsapp }}">💬 WhatsApp</a> · <a href="{{ contact.instagram }}">📷 Instagram</a></div>
        </div>
        {% endfor %}
        {% else %}
        <h1>{% trans 'No contacts!' %}</h1>
        {% endif %}
    </div>
</section>

{% endblock %}